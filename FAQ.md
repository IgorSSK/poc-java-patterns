# ‚ùì FAQ - Perguntas Frequentes

## üìã Geral

### P: Por que Arquitetura Hexagonal?
**R**: A Arquitetura Hexagonal (Ports & Adapters) isola o dom√≠nio da aplica√ß√£o das depend√™ncias externas. Isso significa:
- ‚úÖ Dom√≠nio test√°vel sem AWS, Redis, banco de dados
- ‚úÖ F√°cil trocar implementa√ß√µes (ex: Redis ‚Üí Memcached)
- ‚úÖ Independente de frameworks
- ‚úÖ C√≥digo mais limpo e manuten√≠vel

### P: Quantos Design Patterns foram implementados?
**R**: **6 patterns principais**:
1. Pipeline Pattern
2. Strategy Pattern
3. Factory Pattern
4. Adapter Pattern
5. Repository Pattern
6. Chain of Responsibility

### P: Qual √© o fluxo completo de uma requisi√ß√£o?
**R**: 
```
Frontend ‚Üí Controller ‚Üí Service ‚Üí ValidationChain ‚Üí Pipeline (6 steps) ‚Üí Response
```
Veja diagramas detalhados em [DIAGRAMS.md](DIAGRAMS.md).

---

## üé® Design Patterns

### P: Por que usar Pipeline Pattern?
**R**: Permite processar dados atrav√©s de m√∫ltiplos passos sequenciais com responsabilidade √∫nica. Cada passo pode ser:
- Testado isoladamente
- Adicionado/removido facilmente
- Reordenado conforme necess√°rio
- Trackeado para debugging

### P: Qual a diferen√ßa entre Strategy e Factory?
**R**: 
- **Strategy Pattern**: Define *como* traduzir (algoritmos diferentes)
- **Factory Pattern**: Define *qual* estrat√©gia usar (sele√ß√£o)

### P: Por que Chain of Responsibility para valida√ß√£o?
**R**: Permite encadear m√∫ltiplos validadores onde cada um tem responsabilidade √∫nica. Vantagens:
- Fail-fast (para no primeiro erro)
- F√°cil adicionar/remover validadores
- C√≥digo mais limpo (SRP - Single Responsibility Principle)

---

## üîß Implementa√ß√£o

### P: Como adicionar um novo tipo de tradu√ß√£o?
**R**: 
1. Adicione enum em `TranslationType`
2. Crie nova estrat√©gia implementando `TranslationStrategy`
3. Anote com `@Component`
4. Factory registra automaticamente!

```java
@Component
public class VideoTranslationStrategy implements TranslationStrategy {
    @Override
    public TranslationType getType() {
        return TranslationType.VIDEO;
    }
    // ...
}
```

### P: Como adicionar um novo passo no pipeline?
**R**:
1. Crie classe implementando `PipelineStep`
2. Anote com `@Component`
3. Adicione no construtor de `TranslationPipeline` na ordem desejada

```java
@Component
public class MyCustomStep implements PipelineStep {
    @Override
    public TranslationContext execute(TranslationContext context) {
        // sua l√≥gica
        return context;
    }
}
```

### P: Como adicionar um novo validador?
**R**:
1. Estenda `AbstractValidationHandler`
2. Implemente `doValidate()`
3. Adicione na cadeia em `ValidationChain`

```java
@Component
public class CustomValidator extends AbstractValidationHandler {
    @Override
    protected void doValidate(TranslationRequest request) {
        // valida√ß√£o customizada
    }
}
```

---

## üöÄ Performance

### P: Como funciona o cache multin√≠vel?
**R**: 
- **L1 (Caffeine)**: Cache local, muito r√°pido, 10k entries, 1h TTL
- **L2 (Redis)**: Cache distribu√≠do, compartilhado, 24h TTL

**Fluxo**:
1. Busca em L1 ‚Üí HIT? Retorna
2. Busca em L2 ‚Üí HIT? Promove para L1 e retorna
3. MISS em ambos ‚Üí Traduz ‚Üí Salva em L1+L2

### P: Qual a taxa de hit do cache esperada?
**R**: Depende do uso, mas geralmente:
- **L1**: 70-85% (requisi√ß√µes recentes)
- **L2**: 50-70% (requisi√ß√µes menos frequentes)
- **Overall**: 80-90% com uso normal

### P: Como melhorar a performance?
**R**:
1. ‚úÖ Cache warming (pr√©-carregar tradu√ß√µes comuns)
2. ‚úÖ Batch translations (traduzir m√∫ltiplos textos juntos)
3. ‚úÖ Aumentar TTL do cache
4. ‚úÖ Usar Redis cluster
5. ‚úÖ Async processing para requests grandes
6. ‚úÖ CDN para assets est√°ticos

---

## üîí Seguran√ßa e LGPD

### P: Quais dados sens√≠veis s√£o removidos?
**R**: O `RemoveSensitiveDataStep` remove:
- CPF (123.456.789-00)
- CNPJ (12.345.678/0001-90)
- Emails (user@example.com)
- Telefones ((11) 99999-9999)
- Cart√µes de cr√©dito (1234-5678-9012-3456)

### P: Os dados sens√≠veis s√£o armazenados antes de serem removidos?
**R**: **N√£o**. A remo√ß√£o ocorre no Step 2 do pipeline, **antes** de qualquer tradu√ß√£o ou cache. Fluxo:
```
Input ‚Üí RemoveDuplicates ‚Üí RemoveSensitiveData ‚Üí Cache ‚Üí Translate
```

### P: Como adicionar novo tipo de dado sens√≠vel?
**R**: Adicione Pattern em `RemoveSensitiveDataStep`:
```java
private static final Pattern RG_PATTERN = Pattern.compile("\\d{2}\\.\\d{3}\\.\\d{3}-\\d{1}");
// ...
if (RG_PATTERN.matcher(sanitized).find()) {
    sanitized = RG_PATTERN.matcher(sanitized).replaceAll("[RG REMOVIDO]");
    hasSensitive = true;
}
```

---

## üåê AWS Services

### P: Preciso de conta AWS para testar?
**R**: **Sim**, para funcionalidade completa. Mas voc√™ pode:
- Mockar os adapters para desenvolvimento local
- Usar LocalStack para emular AWS
- Implementar fallback strategies sem AWS

### P: Quais servi√ßos AWS s√£o usados?
**R**:
- **AWS Translate**: Tradu√ß√£o de texto e documentos
- **Amazon Bedrock**: Claude 3 para OCR em imagens
- **DynamoDB**: Dicion√°rio de tradu√ß√µes customizadas

### P: Quanto custa usar AWS Translate?
**R**: (Pre√ßos aproximados, verificar site AWS)
- AWS Translate: $15 por milh√£o de caracteres
- Bedrock Claude 3: $3-15 por milh√£o de tokens
- DynamoDB: $0.25 por milh√£o de leituras
- Com cache 80%, custo reduz ~5x

### P: Como trocar AWS Translate por Google Translate?
**R**: Gra√ßas √† Arquitetura Hexagonal:
1. Crie `GoogleTranslateAdapter implements TranslationPort`
2. Use Google Cloud Translation API
3. Configure no Spring (n√£o muda dom√≠nio!)

```java
@Component
@Primary // Use esta implementa√ß√£o
public class GoogleTranslateAdapter implements TranslationPort {
    private final TranslationServiceClient client;
    // ...
}
```

---

## üìä Observabilidade

### P: Quais m√©tricas s√£o coletadas?
**R**:
- Lat√™ncia de tradu√ß√£o por tipo
- Taxa de hit/miss do cache (L1 e L2)
- N√∫mero de requisi√ß√µes
- Taxa de erro
- Estado do Circuit Breaker
- Duplicatas removidas
- Dados sens√≠veis encontrados

### P: Como visualizar m√©tricas?
**R**:
1. **Prometheus**: scrape `/actuator/prometheus`
2. **Grafana**: importe dashboard ou crie custom
3. **Logs**: veja em `logs/` ou stdout

### P: Como configurar alertas?
**R**: Configure no Prometheus:
```yaml
groups:
  - name: translation_alerts
    rules:
      - alert: HighErrorRate
        expr: rate(translation_errors_total[5m]) > 0.05
        annotations:
          summary: "Alta taxa de erros em tradu√ß√£o"
```

---

## üß™ Testes

### P: Como testar sem AWS real?
**R**: Mock os Ports:
```java
@Test
void testTranslation() {
    TranslationPort mockPort = mock(TranslationPort.class);
    when(mockPort.translate(...)).thenReturn(List.of("Ol√°"));
    
    // Teste dom√≠nio puro
    TranslationService service = new TranslationService(...);
    // ...
}
```

### P: Como executar testes?
**R**:
```bash
# Todos os testes
./mvnw test

# Espec√≠fico
./mvnw test -Dtest=TranslationServiceTest

# Com coverage
./mvnw test jacoco:report
```

### P: Como testar integra√ß√£o com AWS?
**R**: Use testes de integra√ß√£o com `@SpringBootTest`:
```java
@SpringBootTest
@ActiveProfiles("test")
class TranslationIntegrationTest {
    @Autowired
    private TranslationService service;
    
    @Test
    void testRealAWS() {
        // Testa com AWS real (cuidado com custos!)
    }
}
```

---

## üö¢ Deploy

### P: Qual a melhor op√ß√£o de deploy?
**R**: Depende do seu caso:
- **Kubernetes (EKS)**: Melhor para produ√ß√£o escal√°vel
- **Docker Compose**: √ìtimo para dev/test
- **ECS Fargate**: Serverless com AWS
- **Lambda**: Serverless total (cold start issue)

### P: Preciso de Redis em produ√ß√£o?
**R**: **Recomendado** mas n√£o obrigat√≥rio:
- **Com Redis**: Cache distribu√≠do, melhor hit rate
- **Sem Redis**: Apenas cache local (Caffeine), cada inst√¢ncia tem cache pr√≥prio

Para remover Redis:
1. Mantenha apenas Caffeine em `CacheConfig`
2. Adapte `MultiLevelCacheAdapter` para usar s√≥ L1

### P: Como escalar horizontalmente?
**R**: O servi√ßo √© stateless, ent√£o:
```bash
# Kubernetes
kubectl scale deployment translation-service --replicas=10

# Docker
docker-compose up -d --scale translation-service=5

# ECS
aws ecs update-service --desired-count 10
```

### P: Qual tamanho de inst√¢ncia usar?
**R**: Recomenda√ß√µes:
- **Dev/Test**: 512MB RAM, 0.5 vCPU
- **Produ√ß√£o**: 1-2GB RAM, 1-2 vCPU
- **High Load**: 4GB+ RAM, 2-4 vCPU

---

## üîß Troubleshooting

### P: Circuit Breaker est√° aberto, o que fazer?
**R**:
1. Verifique logs de erro
2. Confirme conectividade com AWS
3. Verifique credenciais AWS
4. Aguarde `waitDurationInOpenState` (10s)
5. Circuit breaker testa automaticamente (half-open)

### P: Cache n√£o est√° funcionando
**R**: Checklist:
- [ ] Redis est√° rodando? `docker ps`
- [ ] Conex√£o Redis OK? `redis-cli ping`
- [ ] Caffeine configurado? Veja `CacheConfig`
- [ ] Chaves corretas? Veja logs debug

### P: Erro "UnsupportedLanguageException"
**R**: Idioma n√£o suportado. Idiomas dispon√≠veis:
```
pt, en, es, fr, de, it, ja, ko, zh, ar, ru
```

Para adicionar idioma, adicione em:
1. `TranslationAdapter.SUPPORTED_LANGUAGES`
2. Configure AWS Translate para suportar

### P: Performance est√° lenta
**R**: Investigar:
1. **Cache hit rate**: Deve ser >70%
2. **AWS latency**: Verifique regi√£o
3. **Tamanho dos textos**: Chunking funciona?
4. **Circuit breaker**: Est√° causando delays?
5. **Logs**: Algum step est√° lento?

---

## üìö Documenta√ß√£o

### P: Onde encontrar documenta√ß√£o da API?
**R**:
- **Swagger UI**: http://localhost:8080/swagger-ui.html
- **OpenAPI JSON**: http://localhost:8080/v3/api-docs
- **Exemplos**: [api-examples.http](api-examples.http)

### P: Como contribuir com o projeto?
**R**:
1. Fork o reposit√≥rio
2. Crie branch: `git checkout -b feature/nova-feature`
3. Commit: `git commit -m 'Add nova feature'`
4. Push: `git push origin feature/nova-feature`
5. Abra Pull Request

### P: Onde reportar bugs?
**R**: Abra issue no GitHub com:
- Descri√ß√£o do bug
- Steps to reproduce
- Logs relevantes
- Vers√£o do Java, Spring Boot
- Environment (local, Docker, K8s)

---

## üí° Boas Pr√°ticas

### P: Como organizar c√≥digo seguindo Hexagonal?
**R**: Regras:
1. **Domain** n√£o conhece Infrastructure
2. **Domain** define Ports (interfaces)
3. **Infrastructure** implementa Ports (Adapters)
4. **Application** orquestra Domain
5. Depend√™ncias apontam para dentro (Domain)

### P: Como manter c√≥digo limpo?
**R**:
- ‚úÖ SOLID principles
- ‚úÖ SRP: cada classe uma responsabilidade
- ‚úÖ DRY: n√£o repita c√≥digo
- ‚úÖ Meaningful names
- ‚úÖ Small functions
- ‚úÖ Tests first
- ‚úÖ Code review

### P: Quando criar novo Pattern?
**R**: Crie pattern quando:
- ‚úÖ Problema se repete (DRY)
- ‚úÖ Complexidade cresce
- ‚úÖ M√∫ltiplas varia√ß√µes (Strategy)
- ‚úÖ Processamento multi-step (Pipeline)
- ‚úÖ Abstra√ß√£o necess√°ria (Adapter)

**N√£o crie** pattern para:
- ‚ùå Problema √∫nico
- ‚ùå Over-engineering
- ‚ùå Premature optimization

---

## üéì Aprendizado

### P: √â obrigat√≥rio usar todos esses patterns?
**R**: **N√£o**! Cada pattern resolve um problema espec√≠fico:
- Projeto pequeno? Use s√≥ o necess√°rio
- Projeto grande? Patterns evitam complexidade

### P: Como aprender mais sobre Hexagonal Architecture?
**R**: Recursos:
- **Livros**: "Clean Architecture" (Uncle Bob)
- **Artigos**: Alistair Cockburn (criador)
- **V√≠deos**: YouTube "Hexagonal Architecture"
- **C√≥digo**: Este projeto √© exemplo completo!

### P: Quais outros patterns posso adicionar?
**R**: Patterns √∫teis:
- **Observer**: Para eventos ass√≠ncronos
- **Command**: Para undo/redo
- **Decorator**: Para adicionar funcionalidades
- **Facade**: Para simplificar interface complexa
- **Singleton**: Para recursos √∫nicos (cuidado!)

---

## üîÆ Futuro

### P: Roadmap do projeto?
**R**: Pr√≥ximas features:
- [ ] Autentica√ß√£o OAuth2/JWT
- [ ] Rate limiting
- [ ] WebSocket para streaming
- [ ] GraphQL API
- [ ] Machine Learning para qualidade
- [ ] Suporte a mais formatos (Excel, PPT)
- [ ] Multi-tenancy
- [ ] A/B testing

### P: Como posso contribuir?
**R**: V√°rias formas:
1. Reportar bugs
2. Sugerir features
3. Melhorar documenta√ß√£o
4. Adicionar testes
5. Otimizar performance
6. Criar exemplos

---

## üìû Contato

### P: Onde tirar d√∫vidas?
**R**:
- **Issues**: GitHub Issues
- **Email**: (se dispon√≠vel)
- **Documenta√ß√£o**: Veja [README.md](README.md)

### P: Como dar feedback?
**R**: Adoramos feedback! Use:
- GitHub Issues (bugs/features)
- GitHub Discussions (d√∫vidas gerais)
- Pull Requests (contribui√ß√µes)
- Star ‚≠ê no repo (se gostou!)

---

**Tem mais perguntas? Abra uma issue no GitHub! üöÄ**
